<div class="card" [class.unavailable]="!vianda().estaDisponible" (click)="openViandaModal()">
  <div class="card-image-container">

    @if (vianda().imagenUrl) {
    <img [src]="vianda().imagenUrl" [alt]="vianda().nombreVianda" class="product-image" />
    } @else {
    <img
      class="no-image" src="logo-miviandita-removebg-preview.png" alt="Imagen de vianda no disponible"/>
    }

    @if (!vianda().estaDisponible) {
    <div class="status-badge">NO DISPONIBLE</div>
    }
  </div>

  <!-- Contenido -->
  <div class="card-content">
    <!-- Header (nombre vianda + precio) -->
    <div class="card-header">
      <h3 class="card-title">
        {{ vianda().nombreVianda }}
      </h3>
      <span class="card-price"> $ {{ vianda().precio }} </span>
    </div>

    <!-- Medio (descripción) -->
    <p class="card-description">
      {{ vianda().descripcion }}
    </p>

    <!-- Footer (iconos + botones) -->
    <div class="card-footer">
      <div class="diet-icons">
        @if (vianda().esSinTacc) {
        <div class="icon-badge" title="Sin TACC">
          <app-icon-tacc class="icon active"></app-icon-tacc>
        </div>
        } @if (vianda().esVegetariano) {
        <div class="icon-badge" title="Vegetariano">
          <app-icon-veggie class="icon active"></app-icon-veggie>
        </div>
        } @if (vianda().esVegano) {
        <div class="icon-badge" title="Vegano">
          <app-icon-vegan class="icon active"></app-icon-vegan>
        </div>
        }
      </div>

      <div>
        @if (esDueno()) {
        <!-- DUEÑO ve botón Editar -->
        <button (click)="$event.stopPropagation(); editar.emit()" class="btn-edit" title="Editar vianda">
          <i class="fa-solid fa-pen"></i>
        </button>

        } @else {
        <!-- INVITADO y CLIENTE ven botones agregar/sacar vianda -->
        <div class="quantity-selector">
          <button (click)="$event.stopPropagation(); quitar.emit()" class="btn-qty" [disabled]="cantidadViandaEnMinimo(vianda())">
            <i class="fa-solid fa-minus"></i>
          </button>

          <span class="qty-value">{{ cantidad() }}</span>

          <button (click)="$event.stopPropagation(); agregar.emit()" class="btn-qty" [disabled]="cantidadViandaEnMaximo(vianda())">
            <i class="fa-solid fa-plus"></i>
          </button>
        </div>
        }
      </div>
    </div>
  </div>
</div>
