<div class="card-unificada">
  <div class="header-card">
    <h3 class="titulo-seccion">Pedidos</h3>

    <div class="filtros-container">
      <div class="select-wrapper">
        <label class="select-label">Estado</label>
        <div class="select-custom" [class.open]="openEstado" (click)="toggleEstado($event)">
          <div class="selected-option">{{ pedidoService.filtroEstado() || 'Todos' }}</div>
          <div class="arrow">▾</div>
          @if (openEstado) {
          <ul class="options">
            <li (click)="setEstado(null); $event.stopPropagation()">Todos</li>
            @for (estado of estados; track estado) {
            <li (click)="setEstado(estado); $event.stopPropagation()">{{ estado }}</li>
            }
          </ul>
          }
        </div>
      </div>

      <div class="select-wrapper">
        <label class="select-label">Emprendimiento</label>
        <div class="select-custom" [class.open]="openEmp" (click)="toggleEmp($event)">
          <div class="selected-option">{{ pedidoService.filtroEmprendimiento() || 'Todos' }}</div>
          <div class="arrow">▾</div>
          @if (openEmp) {
          <ul class="options">
            <li (click)="setEmp(null); $event.stopPropagation()">Todos</li>
            @for (emp of pedidoService.emprendimientosUnicos(); track emp) {
            <li (click)="setEmp(emp); $event.stopPropagation()">{{ emp }}</li>
            }
          </ul>
          }
        </div>
      </div>

      <div class="select-wrapper">
        <label class="select-label">Fecha</label>
        <app-date-range-picker
          (fechasSeleccionadas)="pedidoService.filtroFechas.set($event)"
        ></app-date-range-picker>
      </div>
    </div>
  </div>

  <div class="divisor"></div>

  <div class="contenido-card">
    @if (pedidoService.pedidosFiltrados().length === 0) {
    <div class="estado-vacio">
      <p class="sin-pedidos">No tenés pedidos todavía.</p>
    </div>
    } @else {
    <div class="lista-pedidos">
      @for (p of pedidoService.pedidosFiltrados(); track $index) {
      <app-pedido-single-card [pedido]="p"></app-pedido-single-card>
      }
    </div>
    }
  </div>
</div>
